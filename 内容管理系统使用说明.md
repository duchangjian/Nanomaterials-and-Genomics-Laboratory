# 网站内容管理系统使用说明

本文档详细介绍如何使用我们创建的内容管理系统，实现网站文字和图片的便捷替换。

## 系统概述

我们开发了一个基于配置文件的内容管理系统，通过集中管理所有文本内容和图片资源，实现了"一处修改，多处生效"的功能，无需直接编辑HTML文件即可更新网站内容。

## 文件结构

系统包含以下核心文件：

```
├── content-config.json    # 文字内容配置文件
├── images-config.json     # 图片资源配置文件
├── content-loader.js      # 内容加载器脚本
└── 各HTML文件             # 已集成内容加载功能
```

## 1. 修改文字内容

### 操作步骤

1. 打开 `content-config.json` 文件
2. 找到需要修改的内容对应的键值对
3. 修改值（value）部分，保留键（key）不变
4. 保存文件
5. 刷新网站页面，新内容将自动显示

### 配置文件结构说明

配置文件采用JSON格式，按页面和功能模块组织：

```json
{
  "site": {              // 网站基本信息
    "name": "实验室网站",  // 网站名称
    "description": "...",  // 网站描述
    "keywords": "..."      // 关键词
  },
  "nav": {               // 导航栏文本
    "home": "首页",
    "about": "关于我们",
    // ...其他导航项
  },
  "index": {             // 首页内容
    "hero": {            // 英雄区域
      "title": "...",    // 标题
      "subtitle": "..." // 副标题
    },
    // ...其他部分
  },
  // ...其他页面
}
```

### 示例：修改首页标题

要修改首页的主标题，找到并修改以下内容：

```json
"index": {
  "hero": {
    "title": "探索科学前沿，引领创新发展"  // 修改为新标题
  }
}
```

## 2. 修改图片

### 操作步骤

1. 将新图片文件上传到 `images` 文件夹（或相应子文件夹）
2. 打开 `images-config.json` 文件
3. 找到对应图片的配置项
4. 修改 `path` 值为新图片的相对路径
5. 可选：修改 `alt` 值以更新图片描述文本
6. 保存文件
7. 刷新网站页面，新图片将自动显示

### 配置文件结构说明

图片配置按类别组织：

```json
{
  "images": {
    "logo": {            // 网站Logo
      "path": "images/logo.png",
      "alt": "实验室标志"
    },
    "hero": {            // 首页英雄区域图片
      "path": "images/hero-bg.jpg",
      "alt": "实验室环境"
    },
    "students": {        // 学生相关图片
      "placeholder": {   // 默认占位图
        "path": "images/students/placeholder.jpg",
        "alt": "学生照片占位图"
      },
      "profiles": {      // 学生个人照片
        "lihua": {       // 李华的照片
          "path": "images/students/lihua.jpg",
          "alt": "李华照片"
        }
        // ...其他学生照片
      }
    }
    // ...其他图片类别
  }
}
```

### 示例：更换实验室Logo

要更换网站Logo，修改以下内容：

```json
"logo": {
  "path": "images/new-logo.png",  // 新Logo图片路径
  "alt": "新的实验室标志"          // 新的图片描述
}
```

## 3. 添加新内容

### 添加新文本内容

1. 在 `content-config.json` 中找到适当的位置
2. 添加新的键值对
3. 在HTML文件中相应位置添加带有 `data-content` 属性的元素，值为新添加的键名

例如，添加新的研究方向：

```json
// 在content-config.json中
"research": {
  "directions": [
    // ...现有方向
    {
      "title": "新研究方向",
      "description": "研究方向描述"
    }
  ]
}

// 在HTML中
<div data-content="research.directions[2].title"></div>
<div data-content="research.directions[2].description"></div>
```

### 添加新图片

1. 将新图片上传到 `images` 文件夹
2. 在 `images-config.json` 中添加新的图片配置
3. 在HTML中添加带有 `data-image` 属性的图片元素

## 4. 内容加载器高级用法

### JavaScript API

内容加载器提供了JavaScript API，可以在自定义脚本中使用：

```javascript
// 获取文本内容
const title = contentLoader.getText('index.hero.title');

// 获取图片信息
const logoImage = contentLoader.getImage('logo');

// 手动设置元素内容
contentLoader.setElementContent(document.getElementById('myElement'), 'nav.about');

// 手动设置图片
contentLoader.setImage(document.getElementById('myImage'), 'hero');

// 重新加载内容
contentLoader.reload();

// 手动检查配置更新
await contentLoader.checkForUpdates();

// 控制自动刷新
contentLoader.stopAutoRefresh(); // 停止自动刷新
contentLoader.startAutoRefresh(15000); // 启动自动刷新，间隔15秒
```

### 事件监听

内容加载完成后会触发 `contentLoaded` 事件：

```javascript
document.addEventListener('contentLoaded', (event) => {
  const loader = event.detail.contentLoader;
  console.log('内容加载完成');
  // 执行其他操作
});
```

## 5. 自动更新功能

内容加载器现在支持配置文件自动更新功能，当您修改content-config.json或images-config.json文件后，系统会自动检测变更并刷新页面内容，无需手动刷新整个页面。

**自动更新功能特点：**

- 默认每30秒检查一次配置文件更新
- 基于文件的最后修改时间进行对比
- 只在检测到变化时才重新加载内容
- 支持手动触发检查更新

## 6. 使用测试工具

为了方便测试内容更新功能，我们提供了一个测试脚本：

1. 在需要测试的页面上按F12打开开发者工具
2. 在控制台中输入以下命令并按回车：
   ```javascript
   // 加载测试脚本
   const script = document.createElement('script');
   script.src = 'test-content-update.js';
   document.head.appendChild(script);
   ```

3. 页面底部会出现一个测试面板，包含以下功能：
   - 立即检查更新：手动触发配置文件更新检查
   - 强制重载内容：无视更新状态，直接重新加载所有内容

4. 测试自动更新功能的步骤：
   - 打开content-config.json文件
   - 修改任意内容（例如导航栏文字）
   - 保存文件
   - 等待约30秒，或点击"立即检查更新"按钮
   - 观察页面内容是否自动更新

## 7. 图片文件夹结构建议

为了更好地管理图片资源，建议按照以下结构组织图片文件夹：

```
images/
├── logo.png             # Logo文件
├── hero-bg.jpg          # 首页背景图片
├── about-lab.jpg        # 实验室照片
├── research/            # 研究相关图片
│   ├── genome-editing.jpg
│   └── ...
├── students/            # 学生照片
│   ├── placeholder.jpg  # 默认占位图
│   └── ...
├── pi/                  # PI相关图片
│   └── profile.jpg
└── icons/               # 图标文件
    ├── facebook.png
    └── ...
```

## 6. 注意事项

1. **JSON格式**：修改配置文件时请确保保持正确的JSON格式，特别是引号、逗号等符号
2. **路径格式**：图片路径使用相对路径，相对于网站根目录
3. **编码**：配置文件使用UTF-8编码保存
4. **备份**：修改前建议备份原配置文件
5. **错误排查**：如果内容不显示，检查浏览器控制台是否有错误信息
6. **缓存问题**：有时需要强制刷新页面（Ctrl+F5）以清除缓存

## 7. 常见问题解答

**问：修改配置文件后为什么内容没有更新？**
答：请检查：
1. JSON格式是否正确
2. 键名是否与HTML中的data-content值匹配
3. 尝试强制刷新页面清除缓存

**问：如何添加新的页面内容？**
答：首先在content-config.json中添加新的内容项，然后在HTML中相应位置添加带有data-content属性的元素。

**问：图片替换后显示破碎，怎么办？**
答：检查图片路径是否正确，确保图片文件已上传到指定位置，文件名大小写是否匹配。

## 总结

通过本内容管理系统，您可以轻松实现网站文字和图片的更新，无需编辑HTML文件，大大提高了网站维护的效率。如有任何问题或需要进一步定制，请参考配置文件中的注释或联系开发人员。